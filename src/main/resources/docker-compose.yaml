version: '3.8'

services:
  eureka-peer-1:
    build:
      context: ../../../../discovery
      dockerfile: Dockerfile
    image: ljw0829/eureka-server
    hostname: eureka-peer-1
    container_name: eureka-peer-1
    ports:
      - 3001:3001
    environment:
      - USE_PROFILE=peer-1
      - EUREKA_CLIENT_SERVICE-URL_DEFAULT-ZONE= http://eureka-peer-2:3002/eureka/, http://eureka-peer-3:3003/eureka/
  eureka-peer-2:
    image: ljw0829/eureka-server
    hostname: eureka-peer-2
    container_name: eureka-peer-2
    ports:
      - 3002:3002
    environment:
      - USE_PROFILE=peer-2
      - EUREKA_CLIENT_SERVICE-URL_DEFAULT-ZONE= http://eureka-peer-1:3001/eureka/, http://eureka-peer-3:3003/eureka/
  eureka-peer-3:
    image: ljw0829/eureka-server
    hostname: eureka-peer-3
    container_name: eureka-peer-3
    ports:
      - 3003:3003
    environment:
      - USE_PROFILE=peer-3
      - EUREKA_CLIENT_SERVICE-URL_DEFAULT-ZONE= http://eureka-peer-1:3001/eureka/, http://eureka-peer-2:3002/eureka/